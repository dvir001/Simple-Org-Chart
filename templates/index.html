<!DOCTYPE html>
<html lang="en-US" class="i18n-loading">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="index.pageTitle"></title>
    <script src="/static/d3.min.js"></script>
    <script src="/static/jspdf.umd.min.js"></script>
    <style>
        html.i18n-loading body {
            opacity: 0;
        }
    </style>
    <noscript>
        <style>
            html.i18n-loading body {
                opacity: 1 !important;
            }
        </style>
    </noscript>
    <link rel="stylesheet" href="/static/styles.css">

</head>
<body>
    <div class="container">
        <div class="header is-loading">
            <div class="header-skeleton" aria-hidden="true">
                <div class="skeleton-logo"></div>
                <div class="skeleton-text">
                    <div class="skeleton-line skeleton-line--title"></div>
                    <div class="skeleton-line skeleton-line--subtitle"></div>
                </div>
                <div class="skeleton-actions">
                    <div class="skeleton-pill"></div>
                    <div class="skeleton-pill"></div>
                    <div class="skeleton-pill"></div>
                    <div class="skeleton-pill"></div>
                </div>
            </div>
            <div class="header-content loading">
                <img alt="Logo" class="header-logo loading" data-default-src="/static/icon.png" data-hide-on-error="true" data-i18n-alt="index.header.logoAlt">
                <div class="header-text">
                    <h1 data-i18n="index.header.title">Organization Chart</h1>
                    <p data-i18n="index.header.subtitle">Updates daily @ 8:00 PM</p>
                </div>
                <div class="header-actions">
                    <button id="loginBtn" class="logout-btn" type="button" data-i18n="buttons.adminLogin">Admin Login</button>
                    <button id="syncBtn" class="logout-btn sync-btn is-hidden" type="button" data-i18n="buttons.sync">Sync</button>
                    <button id="configBtn" class="logout-btn is-hidden" type="button" data-i18n="buttons.configure">Configure</button>
                    <button id="reportsBtn" class="logout-btn is-hidden" type="button" data-i18n="buttons.reports">Reports</button>
                    <button id="logoutBtn" class="logout-btn is-hidden" type="button" data-i18n="buttons.logout">Logout</button>
                </div>
            </div>
        </div>
        
        <div class="search-bar">
            <div class="search-wrapper">
                <span class="search-icon">üîç</span>
                <input type="text" class="search-input" id="searchInput" placeholder="Search for employees by name, title, or department..." data-i18n-placeholder="index.search.placeholder">
                <div class="search-results" id="searchResults"></div>
            </div>
            <div class="top-user-controls">
                <label for="topUserSearch" class="top-user-label" data-i18n="index.topUser.label">Top-Level User:</label>
                <div class="search-wrapper top-user-search-wrapper">
                    <span class="search-icon">üîç</span>
                    <input type="text" id="topUserSearch" class="search-input" placeholder="Search for top-level user or leave empty for auto-detect..." data-i18n-placeholder="index.topUser.placeholder">
                    <div class="search-results top-user-results" id="topUserResults"></div>
                </div>
                <button id="saveTopUserBtn" class="save-btn" type="button" data-i18n="buttons.save">Save</button>
                <button id="resetTopUserBtn" class="reset-btn" type="button" data-i18n="buttons.reset">Reset</button>
            </div>
        </div>
        
        <div class="main-content">
            <div class="org-chart-container" id="orgChart">
                <button id="fullscreenBtn" class="fullscreen-btn" type="button" title="Toggle fullscreen mode (F11)" aria-label="Toggle fullscreen mode" data-i18n-title="index.toolbar.layout.fullscreenTitle" data-i18n-aria-label="index.toolbar.layout.fullscreenTitle">
                    <span class="fullscreen-icon">‚õ∂</span>
                </button>
                <div class="chart-toolbar">
                    <div class="toolbar-section toolbar-section--layout layout-toggle">
                        <button class="layout-btn active" data-layout="toggle" type="button" aria-label="Vertical layout" data-i18n-aria-label="index.toolbar.layout.vertical">
                            <span class="layout-icon">‚Üì</span>
                        </button>
                        <button id="compactToggleBtn" class="layout-btn" type="button" title="Toggle compact layout for teams" data-i18n-title="index.toolbar.layout.compactTitle">
                            <span class="layout-icon">‚ñ¶</span>
                            <span data-i18n="index.toolbar.layout.compactLabel">Compact Teams</span>
                        </button>
                        <button id="employeeCountToggleBtn" class="layout-btn layout-btn--icon" type="button" title="Toggle employee count badges" aria-label="Toggle employee count badges" data-i18n-title="index.toolbar.layout.employeeCountTitle" data-i18n-aria-label="index.toolbar.layout.employeeCountTitle">
                            <span class="layout-icon" aria-hidden="true">üî¢</span>
                        </button>
                        <button id="highlightNewEmployeesToggleBtn" class="layout-btn layout-btn--icon" type="button" title="Toggle new employee highlights" aria-label="Toggle new employee highlights" data-i18n-title="index.toolbar.layout.newEmployeeHighlightTitle" data-i18n-aria-label="index.toolbar.layout.newEmployeeHighlightTitle">
                            <span class="layout-icon" aria-hidden="true">üåü</span>
                        </button>
                        <button id="profileImageToggleBtn" class="layout-btn layout-btn--icon" type="button" title="Toggle profile images" aria-label="Toggle profile images" data-i18n-title="index.toolbar.layout.profileTitle" data-i18n-aria-label="index.toolbar.layout.profileTitle">
                            <span class="layout-icon" aria-hidden="true">üñºÔ∏è</span>
                        </button>
                        <button id="nameToggleBtn" class="layout-btn layout-btn--icon" type="button" title="Toggle name visibility" aria-label="Toggle name visibility" data-i18n-title="index.toolbar.layout.nameTitle" data-i18n-aria-label="index.toolbar.layout.nameTitle">
                            <span class="layout-icon" aria-hidden="true">üë§</span>
                        </button>
                        <button id="jobTitleToggleBtn" class="layout-btn layout-btn--icon" type="button" title="Toggle job title visibility" aria-label="Toggle job title visibility" data-i18n-title="index.toolbar.layout.jobTitleTitle" data-i18n-aria-label="index.toolbar.layout.jobTitleTitle">
                            <span class="layout-icon" aria-hidden="true">üìù</span>
                        </button>
                        <button id="departmentToggleBtn" class="layout-btn layout-btn--icon" type="button" title="Toggle department visibility" aria-label="Toggle department visibility" data-i18n-title="index.toolbar.layout.departmentTitle" data-i18n-aria-label="index.toolbar.layout.departmentTitle">
                            <span class="layout-icon" aria-hidden="true">üè¢</span>
                        </button>
                        <button id="officeToggleBtn" class="layout-btn layout-btn--icon" type="button" title="Toggle office visibility" aria-label="Toggle office visibility" data-i18n-title="index.toolbar.layout.officeTitle" data-i18n-aria-label="index.toolbar.layout.officeTitle">
                            <span class="layout-icon" aria-hidden="true">üìç</span>
                        </button>
                    </div>
                    <div class="toolbar-section toolbar-section--controls controls">
                        <button class="control-btn is-hidden" data-control="reset-zoom" type="button" data-i18n="index.toolbar.controls.resetZoom">Reset Zoom</button>
                        <button class="control-btn" data-control="zoom-in" type="button" aria-label="Zoom in" data-i18n-aria-label="index.toolbar.controls.zoomIn">+</button>
                        <button class="control-btn" data-control="zoom-out" type="button" aria-label="Zoom out" data-i18n-aria-label="index.toolbar.controls.zoomOut">-</button>
                        <button class="control-btn" data-control="toggle-expand" type="button" data-i18n="index.toolbar.controls.expandAll">Expand All</button>
                        <button class="control-btn" data-control="reset-hidden" type="button" title="Show all previously hidden subtrees" data-i18n="index.toolbar.controls.resetHidden" data-i18n-title="index.toolbar.controls.resetHiddenTitle">Reset Hidden</button>
                        <button class="control-btn" data-control="reset-titles" type="button" title="Restore all job titles to their original values" data-i18n="index.toolbar.controls.resetTitles" data-i18n-title="index.toolbar.controls.resetTitlesTitle">Reset Titles</button>
                        <button class="control-btn" data-control="reset-departments" type="button" title="Restore all departments to their original values" data-i18n="index.toolbar.controls.resetDepartments" data-i18n-title="index.toolbar.controls.resetDepartmentsTitle">Reset Departments</button>
                        <button class="control-btn control-btn--blue" data-control="print" type="button" data-i18n="index.toolbar.controls.print">Print</button>
                        <button class="control-btn control-btn--violet" data-control="export-visible-svg" type="button" data-i18n="index.toolbar.controls.exportVisibleSvg">SVG</button>
                        <button class="control-btn control-btn--teal" data-control="export-visible-png" type="button" data-i18n="index.toolbar.controls.exportVisiblePng">PNG</button>
                        <button class="control-btn control-btn--crimson" data-control="export-visible-pdf" type="button" data-i18n="index.toolbar.controls.exportVisiblePdf">PDF</button>
                        <button class="control-btn control-btn--green" data-control="export-xlsx" type="button" data-i18n="index.toolbar.controls.exportXlsx">XLSX (Full)</button>
                    </div>
                </div>
                <div class="loading">
                    <div class="spinner"></div>
                    <p data-i18n="index.loading">Loading organization chart...</p>
                </div>
            </div>
            
            <div class="employee-detail" id="employeeDetail">
                <div class="detail-header">
                    <button class="close-btn" id="employeeDetailCloseBtn" type="button">√ó</button>
                    <div id="employeeDetailContent"></div>
                </div>
                <div class="employee-info" id="employeeInfo"></div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='i18n.js') }}" defer></script>
    <script src="{{ url_for('static', filename='identity-visibility.js') }}" defer></script>
    <script src="{{ url_for('static', filename='app.js') }}" defer></script>

    <div id="titleEditModalBackdrop" class="modal-backdrop is-hidden" aria-hidden="true"></div>
    <div id="titleEditModal" class="title-edit-modal is-hidden" role="dialog" aria-modal="true" aria-labelledby="titleEditModalLabel" tabindex="-1">
        <div class="title-edit-modal__card">
            <button class="title-edit-modal__close" type="button" data-action="close-title" aria-label="Close" data-i18n-aria-label="index.titleEdit.cancel">√ó</button>
            <form class="title-edit-form">
                <div class="title-edit-modal__header">
                    <h2 id="titleEditModalLabel" data-i18n="index.titleEdit.heading">Edit Job Title</h2>
                    <p class="title-edit-modal__helper" data-role="title-edit-helper" data-i18n="index.titleEdit.instructions">Set a temporary title for this session. Leave blank to restore the original.</p>
                </div>
                <div class="title-edit-modal__body">
                    <div class="title-edit-modal__field">
                        <span class="title-edit-modal__label" data-i18n="index.titleEdit.employeeLabel">Employee</span>
                        <span class="title-edit-modal__value" data-role="title-edit-name"></span>
                    </div>
                    <div class="title-edit-modal__field">
                        <span class="title-edit-modal__label" data-i18n="index.titleEdit.originalLabel">Original title</span>
                        <span class="title-edit-modal__value" data-role="title-edit-original"></span>
                    </div>
                    <div class="title-edit-modal__field">
                        <label class="title-edit-modal__label" for="titleEditInput" data-i18n="index.titleEdit.overrideLabel">Custom title</label>
                        <input id="titleEditInput" class="title-edit-modal__input" type="text" maxlength="120" autocomplete="off" placeholder="" data-i18n-placeholder="index.titleEdit.overridePlaceholder">
                    </div>
                    <div class="title-edit-modal__field">
                        <span class="title-edit-modal__label" data-i18n="index.titleEdit.originalDepartmentLabel">Original department</span>
                        <span class="title-edit-modal__value" data-role="department-edit-original"></span>
                    </div>
                    <div class="title-edit-modal__field">
                        <label class="title-edit-modal__label" for="departmentEditInput" data-i18n="index.titleEdit.overrideDepartmentLabel">Custom department</label>
                        <input id="departmentEditInput" class="title-edit-modal__input" type="text" maxlength="120" autocomplete="off" placeholder="" data-i18n-placeholder="index.titleEdit.overrideDepartmentPlaceholder">
                    </div>
                </div>
                <div class="title-edit-modal__actions">
                    <button class="modal-btn modal-btn--primary" data-action="save-title" type="submit" data-i18n="index.titleEdit.save">Save Title</button>
                    <button class="modal-btn modal-btn--ghost" data-action="clear-title" type="button" data-i18n="index.titleEdit.clear">Clear Custom Title</button>
                    <button class="modal-btn modal-btn--ghost" data-action="clear-department" type="button" data-i18n="index.titleEdit.clearDepartment">Clear Custom Department</button>
                    <button class="modal-btn" data-action="cancel-title" type="button" data-i18n="index.titleEdit.cancel">Cancel</button>
                </div>
            </form>
        </div>
    </div>
</body>
</html>