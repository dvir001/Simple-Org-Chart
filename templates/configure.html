<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="configure.pageTitle" data-i18n-params='{"chartTitle": {{ chart_title|tojson }} }'>{{ chart_title }} - {{ _('configure.pageTitleSuffix', default='Configuration') }}</title>
    <link rel="stylesheet" href="/static/configure.css">
</head>
<body class="is-loading">
    <div class="container">
        <a href="/" class="nav-link" data-i18n="configure.navBack">‚Üê Back to Org Chart</a>
        
        <div class="header">
            <h1 data-i18n="configure.header.title">Configuration Settings</h1>
            <p data-i18n="configure.header.subtitle">Customize your organization chart appearance and behavior</p>
        </div>

        <div class="config-section">
            <h2 data-i18n="configure.sections.appearance.title">üé® Appearance Settings</h2>
            
            <div class="config-group">
                <div class="config-item">
                    <label class="config-label" data-i18n="configure.appearance.chartTitle.label">Chart Title</label>
                    <div class="config-description" data-i18n="configure.appearance.chartTitle.description">Customize the main title displayed in the header</div>
                    <div class="config-controls">
                        <input type="text" id="chartTitle" placeholder="Organization Chart" data-i18n-placeholder="configure.appearance.chartTitle.placeholder">
                        <button class="btn btn-secondary" type="button" data-config-action="reset-chart-title" data-i18n="configure.buttons.resetDefault">Reset to Default</button>
                    </div>
                </div>

                <div class="config-item">
                    <label class="config-label" data-i18n="configure.appearance.headerColor.label">Header Bar Color</label>
                    <div class="config-description" data-i18n="configure.appearance.headerColor.description">Choose the color for the top header bar</div>
                    <div class="config-controls">
                        <input type="color" id="headerColor" value="#0078D4">
                        <input type="text" id="headerColorHex" placeholder="#0078D4" maxlength="7" data-i18n-placeholder="configure.appearance.headerColor.placeholder">
                        <button class="btn btn-secondary" type="button" data-config-action="reset-header-color" data-i18n="configure.buttons.resetDefault">Reset to Default</button>
                    </div>
                    <div class="preview-section">
                        <div class="preview-header" id="headerPreview" data-i18n="configure.appearance.headerColor.preview">
                            Preview Header
                        </div>
                    </div>
                </div>

                <div class="config-item">
                    <label class="config-label" data-i18n="configure.appearance.logo.label">Logo Image</label>
                    <div class="config-description" data-i18n="configure.appearance.logo.description">Upload a custom logo (max 5MB, recommended height 40px, PNG/JPG)</div>
                    <div class="config-controls">
                        <label for="logoUpload" class="file-upload-label" data-i18n="configure.appearance.logo.choose">Choose Logo</label>
                        <input type="file" id="logoUpload" accept="image/*">
                        <span class="current-logo">
                            <img id="currentLogo" src="{{ logo_path or '/static/icon.png' }}" alt="Current Logo" data-i18n-alt="configure.appearance.logo.currentAlt">
                        </span>
                        <button class="btn btn-secondary" type="button" data-config-action="reset-logo" data-i18n="configure.buttons.resetDefault">Reset to Default</button>
                        <span id="logoStatus" class="upload-status"></span>
                    </div>
                    <div id="logoDropZone" class="upload-dropzone" data-i18n="configure.appearance.logo.dropText">Or drag & drop a PNG/JPG here</div>
                </div>

                <div class="config-item">
                    <label class="config-label" data-i18n="configure.appearance.favicon.label">Favicon Image</label>
                    <div class="config-description" data-i18n="configure.appearance.favicon.description">Upload a custom favicon for browser tab icon (max 5MB, recommended 32x32px ICO/PNG)</div>
                    <div class="config-controls">
                        <label for="faviconUpload" class="file-upload-label" data-i18n="configure.appearance.favicon.choose">Choose Favicon</label>
                        <input type="file" id="faviconUpload" accept="image/x-icon,image/png,image/jpeg,.ico">
                        <span class="current-logo">
                            <img id="currentFavicon" src="{{ favicon_image_path or '/favicon.ico' }}" alt="Current Favicon" data-i18n-alt="configure.appearance.favicon.currentAlt">
                        </span>
                        <button class="btn btn-secondary" type="button" data-config-action="reset-favicon" data-i18n="configure.buttons.resetDefault">Reset to Default</button>
                        <span id="faviconStatus" class="upload-status"></span>
                    </div>
                    <div id="faviconDropZone" class="upload-dropzone" data-i18n="configure.appearance.favicon.dropText">Or drag & drop an ICO/PNG/JPG here</div>
                </div>

                <div class="config-item">
                    <label class="config-label" data-i18n="configure.appearance.nodeColors.label">Node Colors by Level</label>
                    <div class="config-description" data-i18n="configure.appearance.nodeColors.description">Customize colors for each hierarchy level</div>
                    <div class="node-color-grid">
                        <div class="config-controls">
                            <span class="node-color-label" data-i18n="configure.appearance.nodeColors.level1">Level 1:</span>
                            <input type="color" id="level0Color" value="#90EE90">
                            <input type="text" id="level0ColorHex" placeholder="#90EE90" maxlength="7" data-i18n-placeholder="configure.appearance.nodeColors.placeholderLevel1">
                        </div>
                        <div class="config-controls">
                            <span class="node-color-label" data-i18n="configure.appearance.nodeColors.level2">Level 2:</span>
                            <input type="color" id="level1Color" value="#FFFFE0">
                            <input type="text" id="level1ColorHex" placeholder="#FFFFE0" maxlength="7" data-i18n-placeholder="configure.appearance.nodeColors.placeholderLevel2">
                        </div>
                        <div class="config-controls">
                            <span class="node-color-label" data-i18n="configure.appearance.nodeColors.level3">Level 3:</span>
                            <input type="color" id="level2Color" value="#E0F2FF">
                            <input type="text" id="level2ColorHex" placeholder="#E0F2FF" maxlength="7" data-i18n-placeholder="configure.appearance.nodeColors.placeholderLevel3">
                        </div>
                        <div class="config-controls">
                            <span class="node-color-label" data-i18n="configure.appearance.nodeColors.level4">Level 4:</span>
                            <input type="color" id="level3Color" value="#FFE4E1">
                            <input type="text" id="level3ColorHex" placeholder="#FFE4E1" maxlength="7" data-i18n-placeholder="configure.appearance.nodeColors.placeholderLevel4">
                        </div>
                        <div class="config-controls">
                            <span class="node-color-label" data-i18n="configure.appearance.nodeColors.level5">Level 5:</span>
                            <input type="color" id="level4Color" value="#E8DFF5">
                            <input type="text" id="level4ColorHex" placeholder="#E8DFF5" maxlength="7" data-i18n-placeholder="configure.appearance.nodeColors.placeholderLevel5">
                        </div>
                        <div class="config-controls">
                            <span class="node-color-label" data-i18n="configure.appearance.nodeColors.level6">Level 6:</span>
                            <input type="color" id="level5Color" value="#FFEAA7">
                            <input type="text" id="level5ColorHex" placeholder="#FFEAA7" maxlength="7" data-i18n-placeholder="configure.appearance.nodeColors.placeholderLevel6">
                        </div>
                        <div class="config-controls">
                            <span class="node-color-label" data-i18n="configure.appearance.nodeColors.level7">Level 7:</span>
                            <input type="color" id="level6Color" value="#FAD7FF">
                            <input type="text" id="level6ColorHex" placeholder="#FAD7FF" maxlength="7" data-i18n-placeholder="configure.appearance.nodeColors.placeholderLevel7">
                        </div>
                        <div class="config-controls">
                            <span class="node-color-label" data-i18n="configure.appearance.nodeColors.level8">Level 8:</span>
                            <input type="color" id="level7Color" value="#D7F8FF">
                            <input type="text" id="level7ColorHex" placeholder="#D7F8FF" maxlength="7" data-i18n-placeholder="configure.appearance.nodeColors.placeholderLevel8">
                        </div>
                        <button class="btn btn-secondary" type="button" data-config-action="reset-node-colors" data-i18n="configure.buttons.resetAllNodeColors">Reset All Node Colors</button>
                    </div>
                </div>
            </div>

            <h2 class="section-heading" data-i18n="configure.sections.behavior.title">‚öôÔ∏è Behavior Settings</h2>
            
            <div class="config-group">
                <div class="config-item">
                    <label class="config-label" data-i18n="configure.behavior.autoUpdate.label">Auto-Update Schedule</label>
                    <div class="config-description" data-i18n="configure.behavior.autoUpdate.description">Set the time and daily schedule for automatic data updates</div>
                    <div class="config-controls">
                        <label class="toggle-switch">
                            <input type="checkbox" id="autoUpdateEnabled" checked>
                            <span class="slider"></span>
                        </label>
                        <span data-i18n="configure.behavior.autoUpdate.enable">Enable Auto-Update</span>
                    </div>
                    <div class="config-controls config-controls--spaced schedule-row">
                        <div class="schedule-field">
                            <div id="updateTimePicker" class="inline-time-picker">
                                <select id="updateHour" class="time-select"></select>
                                <span class="time-separator">:</span>
                                <select id="updateMinute" class="time-select"></select>
                                <input type="hidden" id="updateTime" value="20:00">
                            </div>
                        </div>
                        <button class="btn btn-secondary schedule-row__btn" type="button" data-config-action="reset-update-time" data-i18n="configure.buttons.resetDefault">Reset to Default</button>
                    </div>
                </div>

                <div class="config-item">
                    <label class="config-label" data-i18n="configure.behavior.collapseLevel.label">Initial Collapse Level</label>
                    <div class="config-description" data-i18n="configure.behavior.collapseLevel.description">How many levels to show expanded on initial load</div>
                    <div class="config-controls">
                        <select id="collapseLevel">
                            <option value="1" data-i18n="configure.behavior.collapseLevel.optionLevel1">Show Level 1 only</option>
                            <option value="2" selected data-i18n="configure.behavior.collapseLevel.optionLevel2">Show 2 levels</option>
                            <option value="3" data-i18n="configure.behavior.collapseLevel.optionLevel3">Show 3 levels</option>
                            <option value="4" data-i18n="configure.behavior.collapseLevel.optionLevel4">Show 4 levels</option>
                            <option value="all" data-i18n="configure.behavior.collapseLevel.optionAll">Show all levels</option>
                        </select>
                        <button class="btn btn-secondary" type="button" data-config-action="reset-collapse-level" data-i18n="configure.buttons.resetDefault">Reset to Default</button>
                    </div>
                </div>

                <div class="config-item">
                    <label class="config-label" data-i18n="configure.behavior.search.label">Search Settings</label>
                    <div class="config-description" data-i18n="configure.behavior.search.description">Configure search behavior</div>
                    <div class="config-controls">
                        <label class="toggle-switch">
                            <input type="checkbox" id="searchAutoExpand" checked>
                            <span class="slider"></span>
                        </label>
                        <span data-i18n="configure.behavior.search.autoExpand">Auto-expand to search results</span>
                    </div>
                    <div class="config-controls config-controls--spaced">
                        <label class="toggle-switch">
                            <input type="checkbox" id="searchHighlight" checked>
                            <span class="slider"></span>
                        </label>
                        <span data-i18n="configure.behavior.search.highlight">Highlight search results</span>
                    </div>
                    <div class="config-controls config-controls--spaced">
                        <span class="label-prefix" data-i18n="configure.behavior.search.highlightDurationLabel">Highlight fade duration:</span>
                        <input type="number" id="searchHighlightDuration" min="0" max="60" step="1" value="10" style="width: 80px;">
                        <span data-i18n="configure.behavior.search.seconds">seconds</span>
                    </div>
                </div>

                <div class="config-item">
                    <label class="config-label" data-i18n="configure.behavior.newEmployees.label">New Employee Highlighting</label>
                    <div class="config-description" data-i18n="configure.behavior.newEmployees.description">Set the time window for the "New" badge; viewers toggle highlights in the chart</div>
                    <div class="config-controls config-controls--spaced">
                        <span class="label-prefix" data-i18n="configure.behavior.newEmployees.windowLabel">Consider employees new if joined within:</span>
                        <select id="newEmployeeMonths">
                            <option value="1" data-i18n="configure.behavior.newEmployees.month1">1 month</option>
                            <option value="3" selected data-i18n="configure.behavior.newEmployees.month3">3 months</option>
                            <option value="6" data-i18n="configure.behavior.newEmployees.month6">6 months</option>
                            <option value="12" data-i18n="configure.behavior.newEmployees.month12">12 months</option>
                        </select>
                    </div>
                </div>

                <div class="config-item">
                    <label class="config-label" data-i18n="configure.behavior.topLevelUser.label">Top-Level User</label>
                    <div class="config-description" data-i18n="configure.behavior.topLevelUser.description">Select the root user of the organizational chart (CEO, MD, Chief exec, etc.). Leave empty to auto-detect.</div>
                    <div class="config-controls config-controls--spaced tag-picker-row">
                        <div class="tag-picker-field">
                            <span class="label-prefix" data-i18n="configure.behavior.topLevelUser.selectLabel">Top-level user</span>
                            <div class="single-user-picker" id="topLevelUserPicker" data-target-input="topLevelUserInput">
                                <div class="single-user-picker__control">
                                    <div class="single-user-picker__selected" data-role="selected-user"></div>
                                    <input type="text" class="single-user-picker__input" id="topLevelUserSearch" autocomplete="off" placeholder="Search for user..." data-i18n-placeholder="configure.behavior.topLevelUser.placeholder">
                                </div>
                                <div class="single-user-picker__dropdown" data-role="dropdown" hidden></div>
                            </div>
                            <input type="hidden" id="topLevelUserInput">
                            <input type="hidden" id="topLevelUserIdInput">
                        </div>
                        <button class="btn btn-secondary" type="button" data-config-action="reset-top-level-user" data-i18n="configure.buttons.clear">Clear</button>
                    </div>
                </div>

                <div class="config-item">
                    <label class="config-label" data-i18n="configure.behavior.filtering.label">Employee Filtering</label>
                    <div class="config-description" data-i18n="configure.behavior.filtering.description">Control which employees appear in the organizational chart</div>
                    <div class="config-controls">
                        <label class="toggle-switch">
                            <input type="checkbox" id="hideDisabledUsers" checked>
                            <span class="slider"></span>
                        </label>
                        <span data-i18n="configure.behavior.filtering.hideDisabled">Hide disabled users</span>
                    </div>
                    <div class="config-controls config-controls--spaced">
                        <label class="toggle-switch">
                            <input type="checkbox" id="hideGuestUsers" checked>
                            <span class="slider"></span>
                        </label>
                        <span data-i18n="configure.behavior.filtering.hideGuests">Hide guest users</span>
                    </div>
                    <div class="config-controls config-controls--spaced">
                        <label class="toggle-switch">
                            <input type="checkbox" id="hideNoTitle" checked>
                            <span class="slider"></span>
                        </label>
                        <span data-i18n="configure.behavior.filtering.hideNoTitle">Hide employees with no job title</span>
                    </div>
                    <div class="config-controls config-controls--spaced tag-picker-row">
                        <div class="tag-picker-field">
                            <span class="label-prefix" data-i18n="configure.behavior.filtering.ignoredTitlesLabel">Ignored job titles</span>
                            <div class="tag-picker" id="ignoredTitlesPicker" data-target-input="ignoredTitlesInput">
                                <div class="tag-picker__control">
                                    <div class="tag-picker__tags" data-role="tag-container"></div>
                                    <input type="text" class="tag-picker__input" id="ignoredTitlesSearch" autocomplete="off" placeholder="Search job titles..." data-i18n-placeholder="configure.behavior.filtering.ignoredTitlesPlaceholder">
                                </div>
                                <div class="tag-picker__dropdown" data-role="dropdown" hidden></div>
                            </div>
                            <input type="hidden" id="ignoredTitlesInput">
                        </div>
                        <button class="btn btn-secondary" type="button" data-config-action="reset-ignored-titles" data-i18n="configure.buttons.resetDefault">Reset to Default</button>
                    </div>
                    <div class="config-controls config-controls--spaced tag-picker-row">
                        <div class="tag-picker-field">
                            <span class="label-prefix" data-i18n="configure.behavior.filtering.ignoredDepartmentsLabel">Ignored departments</span>
                            <div class="tag-picker" id="ignoredDepartmentsPicker" data-target-input="ignoredDepartmentsInput">
                                <div class="tag-picker__control">
                                    <div class="tag-picker__tags" data-role="tag-container"></div>
                                    <input type="text" class="tag-picker__input" id="ignoredDepartmentsSearch" autocomplete="off" placeholder="Search departments..." data-i18n-placeholder="configure.behavior.filtering.ignoredDepartmentsPlaceholder">
                                </div>
                                <div class="tag-picker__dropdown" data-role="dropdown" hidden></div>
                            </div>
                            <input type="hidden" id="ignoredDepartmentsInput">
                        </div>
                        <button class="btn btn-secondary" type="button" data-config-action="reset-ignored-departments" data-i18n="configure.buttons.resetDefault">Reset to Default</button>
                    </div>
                    <div class="config-controls config-controls--spaced tag-picker-row">
                        <div class="tag-picker-field">
                            <span class="label-prefix" data-i18n="configure.behavior.filtering.ignoredEmployeesLabel">Ignored employees</span>
                            <div class="tag-picker" id="ignoredEmployeesPicker" data-target-input="ignoredEmployeesInput">
                                <div class="tag-picker__control">
                                    <div class="tag-picker__tags" data-role="tag-container"></div>
                                    <input type="text" class="tag-picker__input" id="ignoredEmployeesSearch" autocomplete="off" placeholder="Search employees..." data-i18n-placeholder="configure.behavior.filtering.ignoredEmployeesPlaceholder">
                                </div>
                                <div class="tag-picker__dropdown" data-role="dropdown" hidden></div>
                            </div>
                            <input type="hidden" id="ignoredEmployeesInput">
                        </div>
                        <button class="btn btn-secondary" type="button" data-config-action="reset-ignored-employees" data-i18n="configure.buttons.resetDefault">Reset to Default</button>
                    </div>
                </div>

                <div class="config-item">
                    <label class="config-label" data-i18n="configure.behavior.multiLine.label">Multi-line Children Threshold</label>
                    <div class="config-description" data-i18n="configure.behavior.multiLine.description">Set the number of direct reports at which a manager's team is wrapped into multiple rows.</div>
                    <div class="config-controls">
                        <span data-i18n="configure.behavior.multiLine.threshold">Threshold:</span>
                        <input type="number" id="multiLineChildrenThreshold" min="5" max="200" step="1" class="number-input-small" placeholder="20" data-i18n-placeholder="configure.behavior.multiLine.placeholder">
                        <button class="btn btn-secondary" type="button" data-config-action="reset-multiline-settings" data-i18n="configure.buttons.resetDefault">Reset to Default</button>
                    </div>
                </div>

                <div class="config-item">
                    <label class="config-label" data-i18n="configure.behavior.print.label">Print Options</label>
                    <div class="config-description" data-i18n="configure.behavior.print.description">Configure print layout settings</div>
                    <div class="config-controls">
                        <select id="printOrientation">
                            <option value="landscape" selected data-i18n="configure.behavior.print.landscape">Landscape</option>
                            <option value="portrait" data-i18n="configure.behavior.print.portrait">Portrait</option>
                        </select>
                        <select id="printSize" class="select-inline">
                            <option value="a4" selected data-i18n="configure.behavior.print.a4">A4</option>
                            <option value="letter" data-i18n="configure.behavior.print.letter">Letter</option>
                            <option value="a3" data-i18n="configure.behavior.print.a3">A3</option>
                        </select>
                    </div>
                </div>
            </div>

            <h2 class="section-heading" data-i18n="configure.sections.directory.title">üìá Directory Integrations</h2>

            <div class="config-group">
                <div class="config-item">
                    <label class="config-label" data-i18n="configure.directory.jsonFeed.label">MicroSIP Directory (JSON)</label>
                    <div class="config-description" data-i18n="configure.directory.jsonFeed.description">Enable a JSON feed for MicroSIP softphones at the specified endpoint.</div>
                    <div class="config-controls">
                        <label class="toggle-switch">
                            <input type="checkbox" id="directoryJsonEnabled">
                            <span class="slider"></span>
                        </label>
                        <span class="toggle-label" data-i18n="configure.directory.jsonFeed.enableLabel">Enable JSON feed</span>
                    </div>
                    <div class="config-controls config-controls--inline" style="margin-top: 0.5rem;">
                        <span class="config-hint" style="margin-right: 0.5rem;">/</span>
                        <input type="text" id="directoryJsonFilename" class="config-input config-input--short" placeholder="contacts" maxlength="32">
                        <span class="config-hint">.json</span>
                    </div>
                </div>

                <div class="config-item">
                    <label class="config-label" data-i18n="configure.directory.xmlFeed.label">Desk Phone Directory (XML)</label>
                    <div class="config-description" data-i18n="configure.directory.xmlFeed.description">Enable an XML feed for Yealink and compatible desk phones at the specified endpoint.</div>
                    <div class="config-controls">
                        <label class="toggle-switch">
                            <input type="checkbox" id="directoryXmlEnabled">
                            <span class="slider"></span>
                        </label>
                        <span class="toggle-label" data-i18n="configure.directory.xmlFeed.enableLabel">Enable XML feed</span>
                    </div>
                    <div class="config-controls config-controls--inline" style="margin-top: 0.5rem;">
                        <span class="config-hint" style="margin-right: 0.5rem;">/</span>
                        <input type="text" id="directoryXmlFilename" class="config-input config-input--short" placeholder="contacts" maxlength="32">
                        <span class="config-hint">.xml</span>
                    </div>
                </div>

                <div class="config-item">
                    <label class="config-label" data-i18n="configure.directory.customContacts.label">Custom Directory Contacts</label>
                    <div class="config-description" data-i18n="configure.directory.customContacts.description">Add contacts that should appear in the directory feeds even if they are not in the org chart. Use one entry per line in the format Name,Number.</div>
                    <div class="config-controls config-controls--stacked">
                        <textarea id="customDirectoryContacts" rows="6" class="config-textarea" placeholder="Ada Lovelace,555-123-4567" data-i18n-placeholder="configure.directory.customContacts.placeholder"></textarea>
                        <div class="config-hint" data-i18n="configure.directory.customContacts.hint">Lines starting with # are ignored. Numbers accept digits, spaces, and punctuation.</div>
                        <button class="btn btn-secondary" type="button" data-config-action="reset-custom-directory-contacts" data-i18n="configure.buttons.resetDefault">Reset to Default</button>
                    </div>
                </div>
            </div>

            <h2 class="section-heading" data-i18n="configure.sections.export.title">üìÑ Export to XLSX Options</h2>

            <div class="config-group">
                <div class="config-item">
                    <label class="config-label" data-i18n="configure.export.columnVisibility.label">Column Visibility</label>
                    <div class="config-description" data-i18n="configure.export.columnVisibility.description">Choose which fields appear in XLSX exports. ‚ÄúShow Admin Only‚Äù keeps the column hidden for regular viewers but includes it when an administrator exports.</div>
                    <div class="export-columns-grid">
                        <div class="column-setting">
                            <span class="column-label" data-i18n="configure.export.columns.name">Name</span>
                            <select id="exportColumnName" class="column-select">
                                <option value="show" data-i18n="configure.export.options.show">Show</option>
                                <option value="hide" data-i18n="configure.export.options.hide">Hide</option>
                                <option value="admin" data-i18n="configure.export.options.admin">Show Admin Only</option>
                            </select>
                        </div>
                        <div class="column-setting">
                            <span class="column-label" data-i18n="configure.export.columns.title">Title</span>
                            <select id="exportColumnTitle" class="column-select">
                                <option value="show" data-i18n="configure.export.options.show">Show</option>
                                <option value="hide" data-i18n="configure.export.options.hide">Hide</option>
                                <option value="admin" data-i18n="configure.export.options.admin">Show Admin Only</option>
                            </select>
                        </div>
                        <div class="column-setting">
                            <span class="column-label" data-i18n="configure.export.columns.department">Department</span>
                            <select id="exportColumnDepartment" class="column-select">
                                <option value="show" data-i18n="configure.export.options.show">Show</option>
                                <option value="hide" data-i18n="configure.export.options.hide">Hide</option>
                                <option value="admin" data-i18n="configure.export.options.admin">Show Admin Only</option>
                            </select>
                        </div>
                        <div class="column-setting">
                            <span class="column-label" data-i18n="configure.export.columns.email">Email</span>
                            <select id="exportColumnEmail" class="column-select">
                                <option value="show" data-i18n="configure.export.options.show">Show</option>
                                <option value="hide" data-i18n="configure.export.options.hide">Hide</option>
                                <option value="admin" data-i18n="configure.export.options.admin">Show Admin Only</option>
                            </select>
                        </div>
                        <div class="column-setting">
                            <span class="column-label" data-i18n="configure.export.columns.phone">Phone</span>
                            <select id="exportColumnPhone" class="column-select">
                                <option value="show" data-i18n="configure.export.options.show">Show</option>
                                <option value="hide" data-i18n="configure.export.options.hide">Hide</option>
                                <option value="admin" data-i18n="configure.export.options.admin">Show Admin Only</option>
                            </select>
                        </div>
                        <div class="column-setting">
                            <span class="column-label" data-i18n="configure.export.columns.businessPhone">Business Phone</span>
                            <select id="exportColumnBusinessPhone" class="column-select">
                                <option value="show" data-i18n="configure.export.options.show">Show</option>
                                <option value="hide" data-i18n="configure.export.options.hide">Hide</option>
                                <option value="admin" data-i18n="configure.export.options.admin">Show Admin Only</option>
                            </select>
                        </div>
                        <div class="column-setting">
                            <span class="column-label" data-i18n="configure.export.columns.hireDate">Hire Date</span>
                            <select id="exportColumnHireDate" class="column-select">
                                <option value="show" data-i18n="configure.export.options.show">Show</option>
                                <option value="hide" data-i18n="configure.export.options.hide">Hide</option>
                                <option value="admin" data-i18n="configure.export.options.admin">Show Admin Only</option>
                            </select>
                        </div>
                        <div class="column-setting">
                            <span class="column-label" data-i18n="configure.export.columns.country">Country</span>
                            <select id="exportColumnCountry" class="column-select">
                                <option value="show" data-i18n="configure.export.options.show">Show</option>
                                <option value="hide" data-i18n="configure.export.options.hide">Hide</option>
                                <option value="admin" data-i18n="configure.export.options.admin">Show Admin Only</option>
                            </select>
                        </div>
                        <div class="column-setting">
                            <span class="column-label" data-i18n="configure.export.columns.state">State</span>
                            <select id="exportColumnState" class="column-select">
                                <option value="show" data-i18n="configure.export.options.show">Show</option>
                                <option value="hide" data-i18n="configure.export.options.hide">Hide</option>
                                <option value="admin" data-i18n="configure.export.options.admin">Show Admin Only</option>
                            </select>
                        </div>
                        <div class="column-setting">
                            <span class="column-label" data-i18n="configure.export.columns.city">City</span>
                            <select id="exportColumnCity" class="column-select">
                                <option value="show" data-i18n="configure.export.options.show">Show</option>
                                <option value="hide" data-i18n="configure.export.options.hide">Hide</option>
                                <option value="admin" data-i18n="configure.export.options.admin">Show Admin Only</option>
                            </select>
                        </div>
                        <div class="column-setting">
                            <span class="column-label" data-i18n="configure.export.columns.office">Office</span>
                            <select id="exportColumnOffice" class="column-select">
                                <option value="show" data-i18n="configure.export.options.show">Show</option>
                                <option value="hide" data-i18n="configure.export.options.hide">Hide</option>
                                <option value="admin" data-i18n="configure.export.options.admin">Show Admin Only</option>
                            </select>
                        </div>
                        <div class="column-setting">
                            <span class="column-label" data-i18n="configure.export.columns.manager">Manager</span>
                            <select id="exportColumnManager" class="column-select">
                                <option value="show" data-i18n="configure.export.options.show">Show</option>
                                <option value="hide" data-i18n="configure.export.options.hide">Hide</option>
                                <option value="admin" data-i18n="configure.export.options.admin">Show Admin Only</option>
                            </select>
                        </div>
                    </div>
                    <div class="config-controls config-controls--spaced">
                        <button class="btn btn-secondary" type="button" data-config-action="reset-export-columns" data-i18n="configure.buttons.resetColumns">Reset Columns to Default</button>
                    </div>
                </div>
            </div>

            <div id="emailReportsSection" style="display: none;">
                <h2 class="section-heading" data-i18n="configure.sections.emailReports.title">üìß Email Reports</h2>

                <div class="config-group">
                    <div class="config-item">
                        <label class="config-label" data-i18n="configure.emailReports.enable.label">Automated Email Reports</label>
                        <div class="config-description" data-i18n="configure.emailReports.enable.description">Send scheduled organization chart reports via email after data synchronization</div>
                        <div class="config-controls">
                            <label class="toggle-switch">
                                <input type="checkbox" id="emailReportsEnabled">
                                <span class="slider"></span>
                            </label>
                            <span class="toggle-label" data-i18n="configure.emailReports.enable.toggleLabel">Enable email reports</span>
                        </div>
                        <div id="smtpStatusMessage" class="config-hint" style="margin-top: 0.5rem;"></div>
                    </div>

                <div class="config-item" id="emailConfigPanel" style="display: none;">
                    <label class="config-label" data-i18n="configure.emailReports.recipient.label">Recipient Email</label>
                    <div class="config-description" data-i18n="configure.emailReports.recipient.description">Email address(es) to receive automated reports (comma-separated for multiple)</div>
                    <div class="config-controls">
                        <input type="text" id="emailRecipient" placeholder="reports@yourcompany.com, admin@yourcompany.com" data-i18n-placeholder="configure.emailReports.recipient.placeholder">
                    </div>
                </div>

                <div class="config-item" id="emailFrequencyPanel" style="display: none;">
                    <label class="config-label" data-i18n="configure.emailReports.frequency.label">Report Frequency</label>
                    <div class="config-description" data-i18n="configure.emailReports.frequency.description">How often to send automated reports</div>
                    <div class="config-controls">
                        <select id="emailFrequency">
                            <option value="daily" data-i18n="configure.emailReports.frequency.daily">Daily</option>
                            <option value="weekly" selected data-i18n="configure.emailReports.frequency.weekly">Weekly</option>
                            <option value="monthly" data-i18n="configure.emailReports.frequency.monthly">Monthly</option>
                        </select>
                    </div>
                </div>

                <div class="config-item" id="emailDayPanel" style="display: none;">
                    <label class="config-label" data-i18n="configure.emailReports.dayOfWeek.label">Day of Week</label>
                    <div class="config-description" data-i18n="configure.emailReports.dayOfWeek.description">Select the day of the week to send weekly reports</div>
                    <div class="config-controls">
                        <select id="emailDayOfWeek">
                            <option value="monday" selected data-i18n="configure.emailReports.dayOfWeek.monday">Monday</option>
                            <option value="tuesday" data-i18n="configure.emailReports.dayOfWeek.tuesday">Tuesday</option>
                            <option value="wednesday" data-i18n="configure.emailReports.dayOfWeek.wednesday">Wednesday</option>
                            <option value="thursday" data-i18n="configure.emailReports.dayOfWeek.thursday">Thursday</option>
                            <option value="friday" data-i18n="configure.emailReports.dayOfWeek.friday">Friday</option>
                            <option value="saturday" data-i18n="configure.emailReports.dayOfWeek.saturday">Saturday</option>
                            <option value="sunday" data-i18n="configure.emailReports.dayOfWeek.sunday">Sunday</option>
                        </select>
                    </div>
                </div>

                <div class="config-item" id="emailMonthPanel" style="display: none;">
                    <label class="config-label" data-i18n="configure.emailReports.dayOfMonth.label">Day of Month</label>
                    <div class="config-description" data-i18n="configure.emailReports.dayOfMonth.description">Which day of the month to send reports</div>
                    <div class="config-controls">
                        <select id="emailDayOfMonth">
                            <option value="first" selected data-i18n="configure.emailReports.dayOfMonth.first">First day</option>
                            <option value="last" data-i18n="configure.emailReports.dayOfMonth.last">Last day</option>
                        </select>
                    </div>
                </div>

                <div class="config-item" id="emailFileTypesPanel" style="display: none;">
                    <label class="config-label" data-i18n="configure.emailReports.fileTypes.label">Attachment Types</label>
                    <div class="config-description" data-i18n="configure.emailReports.fileTypes.description">Select which file formats to include as email attachments</div>
                    <div class="config-controls">
                        <label class="checkbox-label">
                            <input type="checkbox" id="emailFileXlsx" value="xlsx" checked>
                            <span data-i18n="configure.emailReports.fileTypes.xlsx">XLSX (Excel)</span>
                        </label>
                        <label class="checkbox-label" style="margin-left: 1.5rem;">
                            <input type="checkbox" id="emailFilePng" value="png">
                            <span data-i18n="configure.emailReports.fileTypes.png">PNG (Chart Image)</span>
                        </label>
                    </div>
                    <div class="config-hint" style="margin-top: 0.5rem;" data-i18n="configure.emailReports.fileTypes.note">
                        PNG export uses server-side rendering to generate the full organization chart.
                    </div>
                </div>

                <div class="config-item" id="emailTestPanel" style="display: none;">
                    <label class="config-label" data-i18n="configure.emailReports.test.label">Send Reports</label>
                    <div class="config-description" data-i18n="configure.emailReports.test.description">Test your email configuration or send a report immediately</div>
                    <div class="config-controls">
                        <button class="btn btn-secondary" type="button" id="sendTestEmail" data-i18n="configure.emailReports.test.button">Send Test Email</button>
                        <button class="btn btn-primary" type="button" id="sendTestEmailWithAttachments" style="margin-left: 0.5rem;" data-i18n="configure.emailReports.test.manualSendButton">Manual Send Now</button>
                        <span id="testEmailStatus" class="upload-status"></span>
                    </div>
                </div>
            </div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" type="button" data-config-action="save-all" data-i18n="configure.buttons.saveAll">Save All Settings</button>
                <button class="btn btn-danger" type="button" data-config-action="reset-all" data-i18n="configure.buttons.resetAll">Reset Everything to Defaults</button>
                <button class="btn btn-warning" type="button" data-config-action="logout" data-i18n="configure.buttons.logout">Logout</button>
            </div>

            <div id="statusMessage" class="status-message"></div>
        </div>
    </div>

    <div id="unsavedChangesBar" class="unsaved-changes" aria-live="polite">
        <div class="unsaved-changes__content">
            <span class="unsaved-changes__title" data-i18n="configure.unsavedChanges.message">You have unsaved changes</span>
            <span class="unsaved-changes__hint" data-i18n="configure.unsavedChanges.hint">Save your updates or they will be lost.</span>
        </div>
        <div class="unsaved-changes__actions">
            <button class="btn btn-danger" type="button" data-config-action="discard-unsaved" data-i18n="configure.buttons.discard">Discard Changes</button>
            <button class="btn btn-primary" type="button" data-config-action="save-all" data-i18n="configure.buttons.saveAll">Save All Settings</button>
        </div>
    </div>

    <script src="/static/i18n.js" defer></script>
    <script src="/static/configure.js" defer></script>
</body>
</html>
